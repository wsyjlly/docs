<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>YSW-NOTE</title>
    <meta name="description" content="晏沈威的笔记">
    <link rel="icon" href="/assets/logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.2749efcc.css" as="style"><link rel="preload" href="/assets/js/app.2d4845b5.js" as="script"><link rel="preload" href="/assets/js/2.974af1fb.js" as="script"><link rel="preload" href="/assets/js/3.b9e90bed.js" as="script"><link rel="prefetch" href="/assets/js/10.48cab603.js"><link rel="prefetch" href="/assets/js/11.652fa16d.js"><link rel="prefetch" href="/assets/js/12.b0608426.js"><link rel="prefetch" href="/assets/js/13.e9415f24.js"><link rel="prefetch" href="/assets/js/14.dde1bec7.js"><link rel="prefetch" href="/assets/js/15.8b695c03.js"><link rel="prefetch" href="/assets/js/16.647cd73d.js"><link rel="prefetch" href="/assets/js/17.af05518d.js"><link rel="prefetch" href="/assets/js/18.b0600c14.js"><link rel="prefetch" href="/assets/js/19.953b459c.js"><link rel="prefetch" href="/assets/js/20.e2a7f6e3.js"><link rel="prefetch" href="/assets/js/21.60a88409.js"><link rel="prefetch" href="/assets/js/22.d40553da.js"><link rel="prefetch" href="/assets/js/23.eea7414f.js"><link rel="prefetch" href="/assets/js/24.1c179723.js"><link rel="prefetch" href="/assets/js/25.a116c32f.js"><link rel="prefetch" href="/assets/js/26.93e18f12.js"><link rel="prefetch" href="/assets/js/27.e703db15.js"><link rel="prefetch" href="/assets/js/28.9d5a600f.js"><link rel="prefetch" href="/assets/js/29.ec56e0f7.js"><link rel="prefetch" href="/assets/js/30.3419dbef.js"><link rel="prefetch" href="/assets/js/31.5541885c.js"><link rel="prefetch" href="/assets/js/4.383e9253.js"><link rel="prefetch" href="/assets/js/5.29032b90.js"><link rel="prefetch" href="/assets/js/6.3374be4e.js"><link rel="prefetch" href="/assets/js/7.8d4d8ec7.js"><link rel="prefetch" href="/assets/js/8.d15a2d70.js"><link rel="prefetch" href="/assets/js/9.4b953eaf.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2749efcc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">YSW-NOTE</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Java笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java/SpringBoot.html" class="nav-link router-link-exact-active router-link-active">SpringBoot</a></li><li class="dropdown-item"><!----> <a href="/Java/MybatisPlus.html" class="nav-link">MybatisPlus</a></li><li class="dropdown-item"><!----> <a href="/Java/Java基础.html" class="nav-link">Java基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Docker笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Docker/docker命令.html" class="nav-link">docker命令</a></li><li class="dropdown-item"><!----> <a href="/Docker/软件安装.html" class="nav-link">软件安装</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web/Html标签.html" class="nav-link">Html标签</a></li><li class="dropdown-item"><!----> <a href="/Web/CSS3属性.html" class="nav-link">CSS3属性</a></li><li class="dropdown-item"><!----> <a href="/Web/Vue.html" class="nav-link">Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Something</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Other/12306.html" class="nav-link">12306</a></li><li class="dropdown-item"><!----> <a href="/Other/CentOS 7.html" class="nav-link">CentOS 7</a></li><li class="dropdown-item"><!----> <a href="/Other/Git.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/Other/sfow项目部署.html" class="nav-link">SFOW</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Java笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java/SpringBoot.html" class="nav-link router-link-exact-active router-link-active">SpringBoot</a></li><li class="dropdown-item"><!----> <a href="/Java/MybatisPlus.html" class="nav-link">MybatisPlus</a></li><li class="dropdown-item"><!----> <a href="/Java/Java基础.html" class="nav-link">Java基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Docker笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Docker/docker命令.html" class="nav-link">docker命令</a></li><li class="dropdown-item"><!----> <a href="/Docker/软件安装.html" class="nav-link">软件安装</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web/Html标签.html" class="nav-link">Html标签</a></li><li class="dropdown-item"><!----> <a href="/Web/CSS3属性.html" class="nav-link">CSS3属性</a></li><li class="dropdown-item"><!----> <a href="/Web/Vue.html" class="nav-link">Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Something</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Other/12306.html" class="nav-link">12306</a></li><li class="dropdown-item"><!----> <a href="/Other/CentOS 7.html" class="nav-link">CentOS 7</a></li><li class="dropdown-item"><!----> <a href="/Other/Git.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/Other/sfow项目部署.html" class="nav-link">SFOW</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Java笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Java/SpringBoot.html" class="active sidebar-link">SpringBoot</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#_1、文件上传" class="sidebar-link">1、文件上传</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#_2、同源策略配置" class="sidebar-link">2、同源策略配置</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#_3、restful请求风格" class="sidebar-link">3、Restful请求风格</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#_4、拦截器" class="sidebar-link">4、拦截器</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#_5、过滤器、监听器、servlet" class="sidebar-link">5、过滤器、监听器、Servlet</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#_6、aop切面编程" class="sidebar-link">6、AOP切面编程</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#_7、启动系统任务" class="sidebar-link">7、启动系统任务</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#_8、springboot定时任务-scheduled" class="sidebar-link">8、SpringBoot定时任务@Scheduled</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#_9、springboot定时任务quartz" class="sidebar-link">9、SpringBoot定时任务Quartz</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#_10、springboot邮件发送" class="sidebar-link">10、SpringBoot邮件发送</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#_11、springboot数据校验" class="sidebar-link">11、SpringBoot数据校验</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#_12、springboot应用监控" class="sidebar-link">12、SpringBoot应用监控</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#springboot整合mybatisplus-3-0" class="sidebar-link">SpringBoot整合MybatisPlus 3.0</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#springboot整合redis" class="sidebar-link">SpringBoot整合Redis</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#springboot整合swagger-2" class="sidebar-link">SpringBoot整合Swagger 2</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#springboot整合websocket" class="sidebar-link">SpringBoot整合WebSocket</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#springboot整合jms（activemq）" class="sidebar-link">SpringBoot整合JMS（ActiveMQ）</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#springboot整合amqp（rabbitmq）" class="sidebar-link">SpringBoot整合AMQP（RabbitMQ）</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#springboot-docker远程发布" class="sidebar-link">SpringBoot Docker远程发布</a></li><li class="sidebar-sub-header"><a href="/Java/SpringBoot.html#springboot自定义banner" class="sidebar-link">SpringBoot自定义Banner</a></li></ul></li><li><a href="/Java/MybatisPlus.html" class="sidebar-link">MybatisPlus</a></li><li><a href="/Java/Java基础.html" class="sidebar-link">Java基础</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>[TOC]</p> <h1 id="springboot开发笔记"><a href="#springboot开发笔记" aria-hidden="true" class="header-anchor">#</a> SpringBoot开发笔记</h1> <h2 id="_1、文件上传"><a href="#_1、文件上传" aria-hidden="true" class="header-anchor">#</a> 1、文件上传</h2> <blockquote><p>SpringBoot中对文件上传做了简化，使文件上传变得非常方便</p></blockquote> <ol><li><p>依赖添加（pom.xml）（基本依赖）</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>配置</p> <blockquote><p>​		Java中文件上传涉及2个组件，其一是基于commons-fileupload的CommonsMutipartResolver来处理multipart请求，其二是基于Servlet 3.0的StandardServletMultipartResolver来处理multipart请求。Tomcat7开始支持Servlet 3.0，所以SpringBoot内嵌了Tomcat，SpringBoot提供的文件上传自动化配置类MultipartAutoConfiguration，如果开发者未提供MultipartResolver，默认也采用StandardServletMultipartResolver组件，所以SpringBoot文件上传可以做到零配置。</p></blockquote> <ol><li><p>application.properties配置（非必需）</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token comment">#配置文件上传</span>
<span class="token comment">#是否开启文件上传支持，默认true</span>
<span class="token attr-name">spring.servlet.multipart.enabled</span><span class="token punctuation">=</span><span class="token attr-value">true	</span>
<span class="token comment">#文件写入磁盘的阈值，默认为0</span>
<span class="token attr-name">spring.servlet.multipart.file-size-threshold</span><span class="token punctuation">=</span><span class="token attr-value">0</span>
<span class="token comment">#上传文件的临时保存位置</span>
<span class="token attr-name">spring.servlet.multipart.location</span><span class="token punctuation">=</span><span class="token attr-value">D:\\data</span>
<span class="token comment">#上传的单个文件的最大大小，默认1MB</span>
<span class="token attr-name">spring.servlet.multipart.max-file-size</span><span class="token punctuation">=</span><span class="token attr-value">100MB</span>
<span class="token comment">#多文件上传时，文件的总大小，默认10MB</span>
<span class="token attr-name">spring.servlet.multipart.max-request-size</span><span class="token punctuation">=</span><span class="token attr-value">100MB</span>
<span class="token comment">#表示文件是否延迟解析，默认为false</span>
<span class="token attr-name">spring.servlet.multipart.resolve-lazily</span><span class="token punctuation">=</span><span class="token attr-value">false</span>
</code></pre></div></li></ol></li> <li><p>Controller</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">cn<span class="token punctuation">.</span>wsyjlly<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j</span><span class="token punctuation">.</span><span class="token class-name">Logger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j</span><span class="token punctuation">.</span><span class="token class-name">LoggerFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>ui</span><span class="token punctuation">.</span><span class="token class-name">ModelMap</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation</span><span class="token punctuation">.</span><span class="token class-name">PostMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation</span><span class="token punctuation">.</span><span class="token class-name">RestController</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>multipart</span><span class="token punctuation">.</span><span class="token class-name">MultipartFile</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http</span><span class="token punctuation">.</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">File</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>text</span><span class="token punctuation">.</span><span class="token class-name">SimpleDateFormat</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">Date</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">Map</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>UUID<span class="token punctuation">;</span>

<span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.13 - 17:23
 **/</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileUploadController</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> fomartDate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> UPLOAD_PATH <span class="token operator">=</span> <span class="token string">&quot;/uploadFiles/&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Integer</span> SUCCESS <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Integer</span> FAILURE <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/*
     * 单文件上传
     * */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/upload&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ModelMap</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> uploadFile<span class="token punctuation">,</span> <span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ModelMap</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>uploadFile <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span>FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;未选择文件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> map<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">File</span> folder <span class="token operator">=</span> <span class="token function">getRootPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;文件夹路径:&quot;</span><span class="token operator">+</span>folder<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> originalFilename <span class="token operator">=</span> uploadFile<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;文件原名：&quot;</span><span class="token operator">+</span>originalFilename<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> newName <span class="token operator">=</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> originalFilename<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>originalFilename<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> originalFilename<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            uploadFile<span class="token punctuation">.</span><span class="token function">transferTo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>folder<span class="token punctuation">,</span>newName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> filePath <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getScheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;://&quot;</span> <span class="token operator">+</span> request<span class="token punctuation">.</span><span class="token function">getServerName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">+</span> request<span class="token punctuation">.</span><span class="token function">getServerPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> UPLOAD_PATH <span class="token operator">+</span> fomartDate<span class="token operator">+</span><span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> newName<span class="token punctuation">;</span>
            logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;文件访问路径：&quot;</span><span class="token operator">+</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;filePath&quot;</span><span class="token punctuation">,</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span>SUCCESS<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> map<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span>FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> map<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    
    <span class="token comment">/*
     * 多文件上传
     * */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/uploads&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ModelMap</span> <span class="token function">uploads</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span><span class="token punctuation">[</span><span class="token punctuation">]</span> uploadFiles<span class="token punctuation">,</span> <span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ModelMap</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;文件个数：&quot;</span><span class="token operator">+</span>uploadFiles<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//String realPath = ResourceUtils.getURL(&quot;classpath:&quot;).getPath()+UPLOAD_PATH;</span>
        <span class="token class-name">File</span> folder <span class="token operator">=</span> <span class="token function">getRootPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">&gt;</span></span> fileListUploadStatus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token operator">:</span>uploadFiles<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> item <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> originalFilename <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;————————————————————————————————&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;————————————————————————————————&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;文件原名：&quot;</span><span class="token operator">+</span>originalFilename<span class="token punctuation">)</span><span class="token punctuation">;</span>
            logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;文件大小：&quot;</span><span class="token operator">+</span>file<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;文件类型：&quot;</span><span class="token operator">+</span>file<span class="token punctuation">.</span><span class="token function">getContentType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> newName <span class="token operator">=</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> originalFilename<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>originalFilename<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> originalFilename<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                file<span class="token punctuation">.</span><span class="token function">transferTo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>folder<span class="token punctuation">,</span>newName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">String</span> filePath <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getScheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;://&quot;</span> <span class="token operator">+</span> request<span class="token punctuation">.</span><span class="token function">getServerName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">+</span> request<span class="token punctuation">.</span><span class="token function">getServerPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> UPLOAD_PATH <span class="token operator">+</span> fomartDate<span class="token operator">+</span><span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> newName<span class="token punctuation">;</span>
                logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;访问地址：&quot;</span><span class="token operator">+</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
                logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;地址文件名：&quot;</span><span class="token operator">+</span>newName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                item<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;isUpload&quot;</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">,</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
                fileListUploadStatus<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>originalFilename<span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                item<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;isUpload&quot;</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                fileListUploadStatus<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>originalFilename<span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;resultList&quot;</span><span class="token punctuation">,</span>fileListUploadStatus<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> map<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token class-name">File</span> <span class="token function">getRootPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;user.dir&quot;</span><span class="token punctuation">)</span><span class="token operator">+</span>UPLOAD_PATH<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//如果文件夹不存在</span>
            file<span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//创建文件夹</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">String</span> rootPath <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> folder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>rootPath<span class="token operator">+</span><span class="token string">'/'</span> <span class="token operator">+</span> fomartDate<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>folder<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            folder<span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> folder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>静态资源访问路径配置</p> <blockquote><p>如果上传资源需要被访问，则须配置上传文件路径添加静态资源访问路径。</p> <p>注意：在Linux系统和window系统中相对于当前运行位置的盘的根路径都可表示为   ‘/’</p> <p>静态资源文件路径分为两种：</p> <ul><li>相对路径（相对于classes的路径）即：'classpath:'</li> <li>绝对路径：文件系统路径，配置文件系统静态资源路径时须添加前缀：'file:'</li></ul></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.12 - 16:17
 **/</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/*
    * 配置静态资源过滤策略
    * 将静态资源路径映射为访问路径
    * */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addResourceHandlers</span><span class="token punctuation">(</span><span class="token class-name">ResourceHandlerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        registry<span class="token punctuation">.</span><span class="token function">addResourceHandler</span><span class="token punctuation">(</span><span class="token string">&quot;/static/**&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addResourceLocations</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> uploadPath <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;user.dir&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;uploadFiles&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">&quot;\\\\&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">;</span>
        registry<span class="token punctuation">.</span><span class="token function">addResourceHandler</span><span class="token punctuation">(</span><span class="token string">&quot;/uploadFiles/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
        <span class="token function">addResourceLocations</span><span class="token punctuation">(</span><span class="token string">&quot;file:&quot;</span><span class="token operator">+</span>uploadPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;上传文件路径映射：/uploadFiles/**  ————&gt;&gt;  &quot;</span><span class="token operator">+</span>uploadPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <hr> <h2 id="_2、同源策略配置"><a href="#_2、同源策略配置" aria-hidden="true" class="header-anchor">#</a> 2、同源策略配置</h2> <blockquote><p>​		CROS(Cross-Origin Resource Sharing)是由W3C制定的一种跨域资源共享技术标准，其目的就是为了解决前端的跨域请求。</p></blockquote> <p>SpringBoot配置跨域有2种方式，一是方法注解配置，二是全局配置</p> <ol><li><p>注解配置</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/cors&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RestfulCorsController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@CrossOrigin</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;http://localhost:5000&quot;</span><span class="token punctuation">,</span>allowedHeaders <span class="token operator">=</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span>maxAge <span class="token operator">=</span> <span class="token number">1800</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">itemOperator</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">ModelMap</span> params<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> map<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>全局配置</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>
    <span class="token comment">/*
    * 配置全局跨域请求
    * */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addCorsMappings</span><span class="token punctuation">(</span><span class="token class-name">CorsRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           registry<span class="token punctuation">.</span><span class="token function">addMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/cors/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
           <span class="token function">allowedHeaders</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
           <span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
           <span class="token function">maxAge</span><span class="token punctuation">(</span><span class="token number">1800</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
           <span class="token function">allowedOrigins</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

           registry<span class="token punctuation">.</span><span class="token function">addMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
           <span class="token function">allowedHeaders</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
           <span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
           <span class="token function">maxAge</span><span class="token punctuation">(</span><span class="token number">1800</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
           <span class="token function">allowedOrigins</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:5000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <hr> <h2 id="_3、restful请求风格"><a href="#_3、restful请求风格" aria-hidden="true" class="header-anchor">#</a> 3、Restful请求风格</h2> <blockquote><ul><li>在RESTful架构中，每个网址代表一种资源（resource），所以网址中不能有动词，只能有名词，而且所用的名词往往与数据库的表格名对应。一般来说，数据库中的表都是同种记录的&quot;集合&quot;（collection），所以API中的名词也应该使用复数。</li></ul></blockquote> <blockquote><ul><li>对于资源的具体操作类型，由HTTP动词表示。
<ul><li>常用的HTTP动词有下面五个（括号里是对应的SQL命令）。
<ul><li>GET（SELECT）：从服务器取出资源（一项或多项）。</li> <li>POST（CREATE）：在服务器新建一个资源。</li> <li>PUT（UPDATE）：在服务器更新资源（客户端提供改变后的完整资源）。</li> <li>PATCH（UPDATE）：在服务器更新资源（客户端提供改变的属性）。</li> <li>DELETE（DELETE）：从服务器删除资源。</li></ul></li> <li>还有两个不常用的HTTP动词。
<ul><li>HEAD：获取资源的元数据。</li> <li>OPTIONS：获取信息，关于资源的哪些属性是客户端可以改变的。</li></ul></li></ul></li></ul></blockquote> <blockquote><ul><li>举例如下：
<ul><li>GET /zoos：列出所有动物园</li> <li>POST /zoos：新建一个动物园</li> <li>GET /zoos/ID：获取某个指定动物园的信息</li> <li>PUT /zoos/ID：更新某个指定动物园的信息（提供该动物园的全部信息）</li> <li>PATCH /zoos/ID：更新某个指定动物园的信息（提供该动物园的部分信息）</li> <li>DELETE /zoos/ID：删除某个动物园</li> <li>GET /zoos/ID/animals：列出某个指定动物园的所有动物</li> <li>DELETE /zoos/ID/animals/ID：删除某个指定动物园的指定动物</li></ul></li></ul></blockquote> <blockquote><ul><li>状态码
<ul><li>200 OK - [GET]：服务器成功返回用户请求的数据，该操作是幂等的（Idempotent）。</li> <li>201 CREATED - [POST/PUT/PATCH]：用户新建或修改数据成功。</li> <li>202 Accepted - [*]：表示一个请求已经进入后台排队（异步任务）</li> <li>204 NO CONTENT - [DELETE]：用户删除数据成功。</li> <li>400 INVALID REQUEST - [POST/PUT/PATCH]：用户发出的请求有错误，服务器没有进行新建或修改数据的操作，该操作是幂等的。</li> <li>401 Unauthorized - [*]：表示用户没有权限（令牌、用户名、密码错误）。</li> <li>403 Forbidden - [*] 表示用户得到授权（与401错误相对），但是访问是被禁止的。</li> <li>404 NOT FOUND - [*]：用户发出的请求针对的是不存在的记录，服务器没有进行操作，该操作是幂等的。</li> <li>406 Not Acceptable - [GET]：用户请求的格式不可得（比如用户请求JSON格式，但是只有XML格式）。</li> <li>410 Gone -[GET]：用户请求的资源被永久删除，且不会再得到的。</li> <li>422 Unprocesable entity - [POST/PUT/PATCH] 当创建一个对象时，发生一个验证错误。</li> <li>500 INTERNAL SERVER ERROR - [*]：服务器发生错误，用户将无法判断发出的请求是否成功。</li></ul></li></ul></blockquote> <ol><li>SpringBoot请求方法代码参考<div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.10 - 19:00
 * GET（SELECT）：从服务器取出资源（一项或多项）。
 * POST（CREATE）：在服务器新建一个资源。
 * PUT（UPDATE）：在服务器更新资源（客户端提供改变后的完整资源）。
 * PATCH（UPDATE）：在服务器更新资源（客户端提供改变的属性）。
 * DELETE（DELETE）：从服务器删除资源。
 **/</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/cors&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RestfulCorsController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">itemOperator</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">ModelMap</span> params<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> map<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/add&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">addItem</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">ModelMap</span> params<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> map<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@DeleteMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">deleteItem</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PutMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">updateItem</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PatchMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/patch&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">updateItem</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">ModelMap</span> entity<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;STATUS&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@CrossOrigin</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span>allowedHeaders <span class="token operator">=</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span>maxAge <span class="token operator">=</span> <span class="token number">1800</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getItem</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> defaultValue <span class="token operator">=</span> <span class="token string">&quot;1601141019&quot;</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <hr> <h2 id="_4、拦截器"><a href="#_4、拦截器" aria-hidden="true" class="header-anchor">#</a> 4、拦截器</h2> <ol><li><p>创建拦截器</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.13 - 16:52
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileUploadInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;FileUploadInterceptor...preHandle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">ModelAndView</span> modelAndView<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;FileUploadInterceptor...postHandle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCompletion</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;FileUploadInterceptor...afterCompletion&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div></li> <li><p>注册拦截器</p> <ol><li><p>注册方式一：一般注册方式</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.12 - 16:17
 **/</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>
    <span class="token comment">/*
    * 配置拦截器
    * */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token class-name">InterceptorRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileUploadInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
          <span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">&quot;/upload&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>注册方式二：当拦截器中需要注入变量时须提前加载该拦截器</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.12 - 16:17
 **/</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>
    <span class="token comment">/*
    * 配置拦截器
    * */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token class-name">InterceptorRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token function">getFileUploadInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
          <span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">&quot;/upload&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">FileUploadInterceptor</span> <span class="token function">getFileUploadInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FileUploadInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol></li></ol> <hr> <h2 id="_5、过滤器、监听器、servlet"><a href="#_5、过滤器、监听器、servlet" aria-hidden="true" class="header-anchor">#</a> 5、过滤器、监听器、Servlet</h2> <blockquote><p>​		SpringBoot为整合过滤器、监听器、Servlet，定义了3个基本的组件，分别使用@WebServlet、@WebFilter、@WebListener进行标记</p></blockquote> <ol><li><p>项目入口类添加@ServletComponentScan实现对Filter、Listener、Servlet的扫描</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@ServletComponentScan</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo01Application</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Demo01Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>编写过滤器、监听器、Servlet</p> <ul><li><p>过滤器</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.14 - 18:02
 **/</span>
<span class="token annotation punctuation">@WebFilter</span><span class="token punctuation">(</span><span class="token string">&quot;/upload&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileUploadFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">FilterConfig</span> filterConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;FileUploadFilter...init...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> servletRequest<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> servletResponse<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> filterChain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        filterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>servletRequest<span class="token punctuation">,</span>servletResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>监听器</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.14 - 18:27
 **/</span>
<span class="token annotation punctuation">@WebListener</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyServletRequestListener</span> <span class="token keyword">implements</span> <span class="token class-name">ServletRequestListener</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">requestInitialized</span><span class="token punctuation">(</span><span class="token class-name">ServletRequestEvent</span> sre<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;MyServletRequestListener...init...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">requestDestroyed</span><span class="token punctuation">(</span><span class="token class-name">ServletRequestEvent</span> sre<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;MyServletRequestListener...destroyed...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre></div></li> <li><p>Servlet</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.14 - 18:32
 **/</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span>urlPatterns <span class="token operator">=</span> <span class="token string">&quot;/servlet&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;servlet...in&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">doPost</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ol> <hr> <h2 id="_6、aop切面编程"><a href="#_6、aop切面编程" aria-hidden="true" class="header-anchor">#</a> 6、AOP切面编程</h2> <ol><li><p>添加pom依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-aop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>编写切面类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.14 - 17:23
 **/</span>
<span class="token annotation punctuation">@Aspect</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LogAspect</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">&quot;execution(* cn.wsyjlly.controller.*.*(..))&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">&quot;pc()&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> jp<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> jp<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">&quot;方法开始执行...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">&quot;——————————————————————————————&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@After</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;pc()&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">after</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> jp<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> jp<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">&quot;——————————————————————————————&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">&quot;方法执行结束...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@AfterReturning</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;pc()&quot;</span> <span class="token punctuation">,</span> returning <span class="token operator">=</span> <span class="token string">&quot;result&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterReturning</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> jp<span class="token punctuation">,</span><span class="token class-name">Object</span> result<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> jp<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">&quot;方法返回值为：&quot;</span><span class="token operator">+</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@AfterThrowing</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;pc()&quot;</span> <span class="token punctuation">,</span> throwing <span class="token operator">=</span> <span class="token string">&quot;e&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterThrowing</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> jp<span class="token punctuation">,</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> jp<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">&quot;方法抛出异常：&quot;</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">&quot;pc()&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">around</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> pjp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> pjp<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h2 id="_7、启动系统任务"><a href="#_7、启动系统任务" aria-hidden="true" class="header-anchor">#</a> 7、启动系统任务</h2> <blockquote><p>​		SpringBoot对于系统启动时执行的任务，例如配置文件加载，数据库初始化等操作提供了两种解决方案：CommandLineRunner和ApplicationRunner，两者差别主要在于参数。
​		SpringBoot项目启动时会遍历所有的CommandLineRunner和ApplicationRunner的实现类并调用其中的run方法@Order注解可对于这些实现类调用顺序进行排序</p></blockquote> <ol><li><p>CommandLineRunner的实现类Demo</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.14 - 19:36
 * 配置启动系统参数
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCommandLineRunner1</span> <span class="token keyword">implements</span> <span class="token class-name">CommandLineRunner</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MyCommandLineRunner1:&quot;</span><span class="token operator">+</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;——————————————————————&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.14 - 19:36
 * 配置启动系统参数
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCommandLineRunner2</span> <span class="token keyword">implements</span> <span class="token class-name">CommandLineRunner</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MyCommandLineRunner2:&quot;</span><span class="token operator">+</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;——————————————————————&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div></li> <li><p>ApplicationRunner的实现类Demo</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.14 - 19:39
 * 配置启动系统参数
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyApplicationRunner1</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationRunner</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ApplicationArguments</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> nonOptionArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">getNonOptionArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;1-nonOptionArgs:&quot;</span><span class="token operator">+</span>nonOptionArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> optionNames <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">getOptionNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> item<span class="token operator">:</span>optionNames<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;1-Key:&quot;</span><span class="token operator">+</span>item<span class="token operator">+</span><span class="token string">&quot;;value:&quot;</span><span class="token operator">+</span>args<span class="token punctuation">.</span><span class="token function">getOptionValues</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.14 - 19:39
 * 配置启动系统参数
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyApplicationRunner2</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationRunner</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ApplicationArguments</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> nonOptionArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">getNonOptionArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;2-nonOptionArgs:&quot;</span><span class="token operator">+</span>nonOptionArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> optionNames <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">getOptionNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> item<span class="token operator">:</span>optionNames<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;2-Key:&quot;</span><span class="token operator">+</span>item<span class="token operator">+</span><span class="token string">&quot;;value:&quot;</span><span class="token operator">+</span>args<span class="token punctuation">.</span><span class="token function">getOptionValues</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>测试</p> <ul><li>测试参数</li></ul> <p><img src="/assets/img/1563253722760.ffe3df24.png" alt="测试参数"></p> <ul><li>打印结果</li></ul> <p><img src="/assets/img/1563253851016.f2f6c599.png" alt="打印结果"></p></li></ol> <hr> <h2 id="_8、springboot定时任务-scheduled"><a href="#_8、springboot定时任务-scheduled" aria-hidden="true" class="header-anchor">#</a> 8、SpringBoot定时任务@Scheduled</h2> <blockquote><p>定时任务是企业级开发常见的任务，例如定时统计订单数，数据库备份，定时发送短信和邮件，定时统计博客访客等。简单定时任务通过Spring中的@Schedule注解实现，复杂定时任务可以通过集成Quartz来实现。</p></blockquote> <ol><li><p>注解说明</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>
    initialDelay <span class="token operator">=</span> <span class="token number">5000</span><span class="token punctuation">,</span>        <span class="token comment">//第一次执行前延迟的毫秒数</span>
    initialDelayString <span class="token operator">=</span> <span class="token string">&quot;5000&quot;</span><span class="token punctuation">,</span><span class="token comment">//同上面作用一样，只是String类型                        </span>
    fixedDelay <span class="token operator">=</span> <span class="token number">50000</span><span class="token punctuation">,</span>         <span class="token comment">//在最后一次调用结束和下一次调用开始之间以固定周期（以毫秒为单位）执行带注释的方法。（要等待上次任务完成后）</span>
    fixedDelayString <span class="token operator">=</span> <span class="token string">&quot;50000&quot;</span><span class="token punctuation">,</span> <span class="token comment">//同上面作用一样，只是String类型</span>
    fixedRate <span class="token operator">=</span> <span class="token number">5000</span><span class="token punctuation">,</span>           <span class="token comment">//在调用之间以固定的周期（以毫秒为单位）执行带注释的方法。（不需要等待上次任务完成）</span>
    fixedRateString <span class="token operator">=</span> <span class="token string">&quot;5000&quot;</span><span class="token punctuation">,</span>   <span class="token comment">//同上面作用一样，只是String类型</span>
    cron <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                  <span class="token comment">//一个类似cron的表达式，扩展了通常的UN * X定义，包括秒，分，时，星期，月，年的触发器。</span>
    zone <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>                   <span class="token comment">//指明解析cron表达式的时区</span>
<span class="token punctuation">)</span>
</code></pre></div><blockquote><p>注意：定时任务同步执行时，cron、fixedDelay、fixedRate三者区别如图</p></blockquote> <p><img src="/assets/img/schedule.2e0d855a.png" alt="schedule"></p></li> <li><p>cron表达式</p> <blockquote><p>一个cron表达式可以有6个元素或者7个元素组成（“年”这个元素可以省略，省略之后就是默认“每一年”）</p></blockquote> <p>cron表达式属性如下：</p> <div class="language- extra-class"><pre class="language-text"><code>second(秒)， minute(分)， hour(时),day of month(日),month(月),day of week(周几),year(1970－2099)
</code></pre></div><p>字段与值表格如下：</p> <table><thead><tr><th style="text-align:center;">字段</th> <th style="text-align:center;">允许值</th> <th style="text-align:center;">允许的特殊符号</th></tr></thead> <tbody><tr><td style="text-align:center;">秒</td> <td style="text-align:center;">0-59</td> <td style="text-align:center;">,-*/</td></tr> <tr><td style="text-align:center;">分</td> <td style="text-align:center;">0-59</td> <td style="text-align:center;">,-*/</td></tr> <tr><td style="text-align:center;">小时</td> <td style="text-align:center;">0-23</td> <td style="text-align:center;">,-*/</td></tr> <tr><td style="text-align:center;">日期</td> <td style="text-align:center;">1-31</td> <td style="text-align:center;">,-*?/LWC</td></tr> <tr><td style="text-align:center;">月份</td> <td style="text-align:center;">1-12</td> <td style="text-align:center;">,-*/</td></tr> <tr><td style="text-align:center;">星期</td> <td style="text-align:center;">0-7或SUN-SAT 0 7是SUN</td> <td style="text-align:center;">,-*?/LC#</td></tr> <tr><td style="text-align:center;">年</td> <td style="text-align:center;">空, 1970-2099</td> <td style="text-align:center;">, - * /</td></tr></tbody></table> <p>特殊符号释义如下：</p> <table><thead><tr><th style="text-align:center;">特殊符号</th> <th style="text-align:center;">代表含义</th></tr></thead> <tbody><tr><td style="text-align:center;">,</td> <td style="text-align:center;">枚举</td></tr> <tr><td style="text-align:center;">-</td> <td style="text-align:center;">区间</td></tr> <tr><td style="text-align:center;">*</td> <td style="text-align:center;">任意</td></tr> <tr><td style="text-align:center;">/</td> <td style="text-align:center;">步长</td></tr> <tr><td style="text-align:center;">?</td> <td style="text-align:center;">日/星期冲突匹配</td></tr> <tr><td style="text-align:center;">L</td> <td style="text-align:center;">最后</td></tr> <tr><td style="text-align:center;">W</td> <td style="text-align:center;">工作日</td></tr> <tr><td style="text-align:center;">C</td> <td style="text-align:center;">和Calendar联系后计算过的值</td></tr> <tr><td style="text-align:center;">#</td> <td style="text-align:center;">星期 4#2 第2个星期四</td></tr></tbody></table> <p>字符解释</p> <ul><li>其中每个元素可以是一个值(如6),一个连续区间(9-12),一个间隔时间(8-18/4)(/表示每隔4小时),一个列表(1,3,5),通配符。</li> <li>其中的“日”由于&quot;月份中的日期&quot;和&quot;星期&quot;这两个元素互斥的，必须要对其中一个设置“？”。</li> <li>有些子表达式能包含一些范围或列表
<ul><li>例如：子表达式（天（星期））可以为 “MON-FRI”，“MON，WED，FRI”，“MON-WED,SAT”</li></ul></li> <li>“*”字符代表所有可能的值</li> <li>“/”字符用来指定数值的增量
<ul><li>例如：在子表达式（分钟）里的“0/15”表示从第0分钟开始，每15分钟</li> <li>在子表达式（分钟）里的“3/20”表示从第3分钟开始，每20分钟（它和“3，23，43”）的含义一样</li></ul></li> <li>“？”字符仅被用于天（月）和天（星期）两个子表达式，表示不指定值
<ul><li>当2个子表达式其中之一被指定了值以后，为了避免冲突，需要将另一个子表达式的值设为“？”</li></ul></li> <li>“L” 字符仅被用于天（月）和天（星期）两个子表达式，它是单词“last”的缩写
<ul><li>如果在“L”前有具体的内容，它就具有其他的含义了。例如：“6L”表示这个月的倒数第６天</li> <li>注意：在使用“L”参数时，不要指定列表或范围，因为这会导致问题</li></ul></li> <li>“W” 字符代表着平日(Mon-Fri)，并且仅能用于日域中。它用来指定离指定日的最近的一个平日。大部分的商业处理都是基于工作周的，所以 W 字符可能是非常重要的。
<ul><li>例如，日域中的 15W 意味着 “离该月15号的最近一个平日。” 假如15号是星期六，那么 trigger 会在14号(星期五)触发，因为星期四比星期一离15号更近。</li></ul></li> <li>“C”：代表“Calendar”的意思。它的意思是计划所关联的日期，如果日期没有被关联，则相当于日历中所有日期。例如5C在日期字段中就相当于日历5日以后的第一天。1C在星期字段中相当于星期日后的第一天。</li></ul></li> <li><p>cron表达式示例：</p> <div class="language- extra-class"><pre class="language-text"><code>0 0 0 * * * -- 每天零时执行一次
0 0/15 14,18 * * ? -- 每天14点整和18点整，每隔15分钟执行一次
0 15 10 ? * 1-6 -- 每个月的周一到周六 10:15分执行一次
0 0 2 ? * 6L -- 每个月的最后一个周六凌晨2点执行一次
0 0 2 LW * ? -- 每个月的最后一个工作日凌晨2点执行一次
0 0 2-4 ? * 1#1 -- 每个月的第一个周一凌晨2点到4点期间，每个整点都执行一次

0 0 10,14,16 * * ?  每天上午10点，下午2点，4点
0 0/30 9-17 * * ?   朝九晚五工作时间内每半小时
0 0 12 ? * WED     表示每个星期三中午12点
0 0 12 * * ?           每天中午12点触发
0 15 10 ? * *         每天上午10:15触发（这个和下一个案例说明，必须&quot;月份中的日期&quot;和&quot;星期&quot;中有一个设置为“？”）
0 15 10 * * ?         每天上午10:15触发
0 15 10 * * ? *       每天上午10:15触发（7个元素类型案例，第七个元素代表年）
0 15 10 * * ? 2005     2005年的每天上午10:15触发
0 * 14 * * ?           在每天下午2点到下午2:59期间的每1分钟触发
0 0/5 14 * * ?       在每天下午2点到下午2:55期间的每5分钟触发
0 0/5 14,18 * * ?  在每天下午2点到2:55期间和下午6点到6:55期间的每5分钟触发
0 0-5 14 * * ?       在每天下午2点到下午2:05期间的每1分钟触发
0 10,44 14 ? 3 WED      每年三月的星期三的下午2:10和2:44触发
0 15 10 ? * MON-FRI    周一至周五的上午10:15触发
0 15 10 15 * ?       每月15日上午10:15触发
0 15 10 L * ?         每月最后一日的上午10:15触发
0 15 10 ? * 6L       每月的最后一个星期五上午10:15触发
0 15 10 ? * 6L 2002-2005    2002年至2005年的每月的最后一个星期五上午10:15触发
0 15 10 ? * 6#3     每月的第三个星期五上午10:15触发
</code></pre></div></li></ol> <hr> <h2 id="_9、springboot定时任务quartz"><a href="#_9、springboot定时任务quartz" aria-hidden="true" class="header-anchor">#</a> 9、SpringBoot定时任务Quartz</h2> <blockquote><p>quartz是一个功能丰富的开源作业调度库</p></blockquote> <ol><li><p>添加pom依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-quartz<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>创建定时Job</p> <ul><li>通过普通JavaBean创建，添加@Component注解将之注册到容器</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 14:40
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScheduleDemo2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">schedule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ScheduleDemo2.schedule...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>通过继承抽象类QuartzJobBean创建，该方式需要实现该类中的executeInternal方法，该方法在任务被调用时使用。</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 14:40
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScheduleDemo3</span> <span class="token keyword">extends</span> <span class="token class-name">QuartzJobBean</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">executeInternal</span><span class="token punctuation">(</span><span class="token class-name">JobExecutionContext</span> jobExecutionContext<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ScheduleDemo3.executeInternal...&quot;</span><span class="token operator">+</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div></li> <li><p>创建Quartz配置类QuartzConfig对Job进行配置</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 14:47
 **/</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuartzConfig</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">MethodInvokingJobDetailFactoryBean</span> <span class="token function">jobDetail1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">MethodInvokingJobDetailFactoryBean</span> bean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MethodInvokingJobDetailFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setTargetBeanName</span><span class="token punctuation">(</span><span class="token string">&quot;scheduleDemo2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setTargetMethod</span><span class="token punctuation">(</span><span class="token string">&quot;schedule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">JobDetailFactoryBean</span> <span class="token function">jobDetail2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">JobDetailFactoryBean</span> bean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JobDetailFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setJobClass</span><span class="token punctuation">(</span><span class="token class-name">ScheduleDemo3</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JobDataMap</span> jobDataMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JobDataMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jobDataMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ysw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setJobDataMap</span><span class="token punctuation">(</span>jobDataMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setDurability</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">SimpleTriggerFactoryBean</span> <span class="token function">simpleTrigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">SimpleTriggerFactoryBean</span> bean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleTriggerFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setJobDetail</span><span class="token punctuation">(</span><span class="token function">jobDetail1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setRepeatCount</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setStartDelay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setRepeatInterval</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">CronTriggerFactoryBean</span> <span class="token function">cronTrigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">CronTriggerFactoryBean</span> bean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CronTriggerFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setJobDetail</span><span class="token punctuation">(</span><span class="token function">jobDetail2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setCronExpression</span><span class="token punctuation">(</span><span class="token string">&quot;* * * * * ?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">SchedulerFactoryBean</span> <span class="token function">schedulerFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">SchedulerFactoryBean</span> bean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SchedulerFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SimpleTrigger</span> simpleTrigger <span class="token operator">=</span> <span class="token function">simpleTrigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CronTrigger</span> cronTrigger <span class="token operator">=</span> <span class="token function">cronTrigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setTriggers</span><span class="token punctuation">(</span>simpleTrigger<span class="token punctuation">,</span>cronTrigger<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <hr> <h2 id="_10、springboot邮件发送"><a href="#_10、springboot邮件发送" aria-hidden="true" class="header-anchor">#</a> 10、SpringBoot邮件发送</h2> <ol><li><p>添加pom依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-mail<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>application.properties配置</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">spring.mail.host</span><span class="token punctuation">=</span><span class="token attr-value">smtp.qq.com</span>
<span class="token attr-name">spring.mail.port</span><span class="token punctuation">=</span><span class="token attr-value">465</span>
<span class="token attr-name">spring.mail.username</span><span class="token punctuation">=</span><span class="token attr-value">wsyjlly@qq.com</span>
<span class="token attr-name">spring.mail.password</span><span class="token punctuation">=</span><span class="token attr-value">khhvydlahiqjbjaj</span>
<span class="token attr-name">spring.mail.default-encoding</span><span class="token punctuation">=</span><span class="token attr-value">UTF-8</span>
<span class="token attr-name">spring.mail.properties.mail.smtp.socketFactory.class</span><span class="token punctuation">=</span><span class="token attr-value">javax.net.ssl.SSLSocketFactory</span>
<span class="token attr-name">spring.mail.properties.mail.debug</span><span class="token punctuation">=</span><span class="token attr-value">true</span>
</code></pre></div></li> <li><p>编写邮件发送服务</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.16 - 17:32
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MailService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">JavaMailSender</span> javaMailSender<span class="token punctuation">;</span>
    
    <span class="token comment">//简单邮件发送</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendSimpleSender</span><span class="token punctuation">(</span><span class="token class-name">String</span> from<span class="token punctuation">,</span><span class="token class-name">String</span> <span class="token keyword">to</span><span class="token punctuation">,</span><span class="token class-name">String</span> cc<span class="token punctuation">,</span><span class="token class-name">String</span> subject<span class="token punctuation">,</span><span class="token class-name">String</span> content<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">SimpleMailMessage</span> simpleMailMessage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleMailMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        simpleMailMessage<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">;</span>
        simpleMailMessage<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span><span class="token keyword">to</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        simpleMailMessage<span class="token punctuation">.</span><span class="token function">setCc</span><span class="token punctuation">(</span>cc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        simpleMailMessage<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span>subject<span class="token punctuation">)</span><span class="token punctuation">;</span>
        simpleMailMessage<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
        javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>simpleMailMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//带附件的邮件发送</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendAttachFileMail</span><span class="token punctuation">(</span><span class="token class-name">String</span> from<span class="token punctuation">,</span> <span class="token class-name">String</span> <span class="token keyword">to</span><span class="token punctuation">,</span> <span class="token class-name">String</span> subject<span class="token punctuation">,</span> <span class="token class-name">String</span> content<span class="token punctuation">,</span> <span class="token class-name">File</span> file<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MessagingException</span> <span class="token punctuation">{</span>
        <span class="token class-name">MimeMessage</span> mimeMessage <span class="token operator">=</span> javaMailSender<span class="token punctuation">.</span><span class="token function">createMimeMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MimeMessageHelper</span> helper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MimeMessageHelper</span><span class="token punctuation">(</span>mimeMessage<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        helper<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">;</span>
        helper<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span><span class="token keyword">to</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        helper<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span>subject<span class="token punctuation">)</span><span class="token punctuation">;</span>
        helper<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
        helper<span class="token punctuation">.</span><span class="token function">addAttachment</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
        javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>mimeMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendMailWithImg</span><span class="token punctuation">(</span><span class="token class-name">String</span> from<span class="token punctuation">,</span> <span class="token class-name">String</span> <span class="token keyword">to</span><span class="token punctuation">,</span> <span class="token class-name">String</span> subject<span class="token punctuation">,</span> <span class="token class-name">String</span> content<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> srcPath<span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> resIDs<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MessagingException</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>srcPath<span class="token punctuation">.</span>length <span class="token operator">!=</span> resIDs<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;发送失败！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">MimeMessage</span> mimeMessage <span class="token operator">=</span> javaMailSender<span class="token punctuation">.</span><span class="token function">createMimeMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MimeMessageHelper</span> helper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MimeMessageHelper</span><span class="token punctuation">(</span>mimeMessage<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        helper<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">;</span>
        helper<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span><span class="token keyword">to</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        helper<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span>subject<span class="token punctuation">)</span><span class="token punctuation">;</span>
        helper<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> srcPath<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">FileSystemResource</span> resource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>srcPath<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            helper<span class="token punctuation">.</span><span class="token function">addInline</span><span class="token punctuation">(</span>resIDs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>mimeMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>发送邮件</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.10 - 19:00
 **/</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ControllerDemo1</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">MailService</span> mailService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/mail1&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">mail1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        mailService<span class="token punctuation">.</span><span class="token function">sendSimpleSender</span><span class="token punctuation">(</span><span class="token string">&quot;wsyjlly@qq.com&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;895864393@qq.com&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;211874876@qq.com&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;你爱我吗&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;你这个坏孩子！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/mail2&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">mail2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MessagingException</span> <span class="token punctuation">{</span>
        mailService<span class="token punctuation">.</span><span class="token function">sendAttachFileMail</span><span class="token punctuation">(</span><span class="token string">&quot;wsyjlly@qq.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;wsyjlly@qq.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;你信命吗？&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;你这个坏孩子！&quot;</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;./uploadFiles/abc.gif&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/mail3&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">mail3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MessagingException</span> <span class="token punctuation">{</span>
        mailService<span class="token punctuation">.</span><span class="token function">sendMailWithImg</span><span class="token punctuation">(</span><span class="token string">&quot;wsyjlly@qq.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;wsyjlly@qq.com&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;你信神吗？&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&lt;div&gt;hello,坏孩子！&quot;</span>
                <span class="token operator">+</span><span class="token string">&quot;&lt;div&gt;&lt;img src='cid:p01'/&gt;&lt;/div&gt;&quot;</span>
                <span class="token operator">+</span><span class="token string">&quot;&lt;div&gt;&lt;img src='cid:p02'/&gt;&lt;/div&gt;&quot;</span>
                <span class="token operator">+</span><span class="token string">&quot;&lt;/div&gt;&quot;</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;./mail/aaa.jpg&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;./mail/abc.gif&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;p01&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;p02&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>测试链接</p> <ul><li>http://localhost:8080/mail1</li> <li>http://localhost:8080/mail2</li> <li>http://localhost:8080/mail3</li></ul></li> <li><p>发送成功</p></li></ol> <hr> <h2 id="_11、springboot数据校验"><a href="#_11、springboot数据校验" aria-hidden="true" class="header-anchor">#</a> 11、SpringBoot数据校验</h2> <ol><li><p>添加pom依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>编写实体类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.29 - 12:18
 **/</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@Accessors</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Message</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> mid<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>max <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.content.size}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.content.notnull}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>max <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.column1.size}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.column1.notnull}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;column_200&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> column1<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>max <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.column2.size}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.column2.notnull}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;column_500&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> column2<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>max <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.column3.size}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.column3.notnull}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;column_5000&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> column3<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>ValidationMessages.properties配置</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">message.content.notnull</span><span class="token punctuation">=</span><span class="token attr-value">该字段不能为空</span>
<span class="token attr-name">message.column1.notnull</span><span class="token punctuation">=</span><span class="token attr-value">该字段不能为空</span>
<span class="token attr-name">message.column2.notnull</span><span class="token punctuation">=</span><span class="token attr-value">该字段不能为空</span>
<span class="token attr-name">message.column3.notnull</span><span class="token punctuation">=</span><span class="token attr-value">该字段不能为空</span>
<span class="token attr-name">message.content.size</span><span class="token punctuation">=</span><span class="token attr-value">内容长度过短</span>
<span class="token attr-name">message.column1.size</span><span class="token punctuation">=</span><span class="token attr-value">内容长度过短</span>
<span class="token attr-name">message.column2.size</span><span class="token punctuation">=</span><span class="token attr-value">内容长度过短</span>
<span class="token attr-name">message.column3.size</span><span class="token punctuation">=</span><span class="token attr-value">内容长度过短</span>
</code></pre></div><p><img src="/assets/img/1563358182687.a57c5a46.png" alt="1563358182687"></p></li> <li><p>Controller校验</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 17:34
 **/</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/message&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MessageController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/validate&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token annotation punctuation">@Validated</span> <span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">BindingResult</span> result<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">hasErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> list<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getAllErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ObjectError</span> item <span class="token operator">:</span> result<span class="token punctuation">.</span><span class="token function">getAllErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p><strong>分组校验</strong></p> <ul><li><p>创建分组接口</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 18:29
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ValidationGroup1</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 18:29
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ValidationGroup2</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div></li> <li><p>实体类添加分组</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.29 - 12:18
 **/</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@Accessors</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Message</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> mid<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>max <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.content.size}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.content.notnull}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>max <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.column1.size}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.column1.notnull}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;column_200&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> column1<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>max <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.column2.size}&quot;</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token class-name">ValidationGroup1</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.column2.notnull}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;column_500&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> column2<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>max <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.column3.size}&quot;</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">ValidationGroup1</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">ValidationGroup2</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;{message.column3.notnull}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;column_5000&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> column3<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>Controller校验指定分组</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 17:34
 **/</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ValidateController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/validate1&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token annotation punctuation">@Validated</span> <span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">BindingResult</span> result<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token function">getObjects</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/validate2&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span> <span class="token function">validate2</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token annotation punctuation">@Validated</span><span class="token punctuation">(</span><span class="token class-name">ValidationGroup1</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">BindingResult</span> result<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token function">getObjects</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/validate3&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span> <span class="token function">validate3</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token annotation punctuation">@Validated</span><span class="token punctuation">(</span><span class="token class-name">ValidationGroup2</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">BindingResult</span> result<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token function">getObjects</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">getObjects</span><span class="token punctuation">(</span><span class="token class-name">BindingResult</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">hasErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ObjectError</span> item <span class="token operator">:</span> result<span class="token punctuation">.</span><span class="token function">getAllErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ol> <hr> <h2 id="_12、springboot应用监控"><a href="#_12、springboot应用监控" aria-hidden="true" class="header-anchor">#</a> 12、SpringBoot应用监控</h2> <ol><li><p>添加pom依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>application.properties配置</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token comment">#actuator</span>
<span class="token attr-name">management.endpoint.shutdown.enabled</span><span class="token punctuation">=</span><span class="token attr-value">true</span>
<span class="token comment">#暴露所有端点</span>
<span class="token attr-name">management.endpoints.web.exposure.include</span><span class="token punctuation">=</span><span class="token attr-value">*</span>
<span class="token comment">#management.endpoints.web.exposure.include=mappings,metrics</span>
<span class="token comment">#management.endpoints.enabled-by-default=false</span>
<span class="token comment">#management.endpoint.info.enabled=true</span>
</code></pre></div></li></ol> <hr> <h2 id="springboot整合mybatisplus-3-0"><a href="#springboot整合mybatisplus-3-0" aria-hidden="true" class="header-anchor">#</a> SpringBoot整合MybatisPlus 3.0</h2> <ol><li><p>添加pom依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- druid数据库连接池启动器 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>druid-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.1.9<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.1.46<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- mybatis-plus启动器 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>application.properties配置</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">spring.datasource.type</span><span class="token punctuation">=</span><span class="token attr-value">com.alibaba.druid.pool.DruidDataSource</span>
<span class="token attr-name">spring.datasource.username</span><span class="token punctuation">=</span><span class="token attr-value">root</span>
<span class="token attr-name">spring.datasource.password</span><span class="token punctuation">=</span><span class="token attr-value">123</span>
<span class="token attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost:3306/mp_demo?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false</span>
</code></pre></div></li> <li><p>编写实体类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.29 - 12:18
 **/</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@Accessors</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Message</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> mid<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;column_200&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> column1<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;column_500&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> column2<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;column_5000&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> column3<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>编写mapper接口继承BaseMapper接口的数据操作方法</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.29 - 12:30
 **/</span>
<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MessageMapper</span> <span class="token keyword">extends</span> <span class="token class-name">BaseMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div></li> <li><p>编写Service</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.29 - 12:33
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MessageService</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAllMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">&gt;</span></span> <span class="token function">getMessageByMid</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> mid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> <span class="token function">fetchOne</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">,</span><span class="token class-name">Integer</span> mid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> <span class="token function">updateMessageByModuleIdAndMessageId</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> <span class="token function">addMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> <span class="token function">deleteMessage</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> mid<span class="token punctuation">,</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.29 - 13:29
 **/</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MessageServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">MessageService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MessageMapper</span> messageMapper<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAllMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> messageMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">&gt;</span></span> <span class="token function">getMessageByMid</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> mid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> messageMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;mid&quot;</span><span class="token punctuation">,</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">fetchOne</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">,</span><span class="token class-name">Integer</span> mid<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> messageMapper<span class="token punctuation">.</span><span class="token function">selectCount</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;mid&quot;</span><span class="token punctuation">,</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">updateMessageByModuleIdAndMessageId</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> messageMapper<span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">addMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> messageMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">deleteMessage</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> mid<span class="token punctuation">,</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token string">&quot;-&quot;</span><span class="token operator">+</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> messageMapper<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;mid&quot;</span><span class="token punctuation">,</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>编写Controller</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.29 - 12:52
 **/</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MessageService</span> messageService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/messages&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ModelMap</span> <span class="token function">getMessages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">ModelMap</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;messages&quot;</span><span class="token punctuation">,</span>messageService<span class="token punctuation">.</span><span class="token function">getAllMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;module1&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getMessageType1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> messageService<span class="token punctuation">.</span><span class="token function">getMessageByMid</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;module2&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getMessageType2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> messageService<span class="token punctuation">.</span><span class="token function">getMessageByMid</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/message&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ModelMap</span> <span class="token function">addMessage</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">Message</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">ModelMap</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Integer</span> result <span class="token operator">=</span> messageService<span class="token punctuation">.</span><span class="token function">addMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;tip&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;添加成功！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;tip&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;添加失败！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> map<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@DeleteMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/{mid}/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ModelMap</span> <span class="token function">deleteMessage</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Integer</span> mid<span class="token punctuation">,</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ModelMap</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Integer</span> result <span class="token operator">=</span> messageService<span class="token punctuation">.</span><span class="token function">deleteMessage</span><span class="token punctuation">(</span>mid<span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;tip&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;删除成功！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;tip&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;删除失败！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> map<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@PatchMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/message&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ModelMap</span> <span class="token function">updateMessage</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">Message</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Integer</span> one <span class="token operator">=</span> messageService<span class="token punctuation">.</span><span class="token function">fetchOne</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> message<span class="token punctuation">.</span><span class="token function">getMid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ModelMap</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>one<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">Integer</span> result <span class="token operator">=</span> messageService<span class="token punctuation">.</span><span class="token function">updateMessageByModuleIdAndMessageId</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;tip&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;更新成功！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;tip&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;更新失败！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;tip&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;查询异常！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> map<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>显示结果</p> <p><img src="/assets/img/1563255521822.2f619f53.png" alt="http://localhost:8080/modules"></p> <p><img src="/assets/img/1563255568202.4ec82418.png" alt="打印日志"></p></li></ol> <h2 id="springboot整合redis"><a href="#springboot整合redis" aria-hidden="true" class="header-anchor">#</a> SpringBoot整合Redis</h2> <blockquote><p>本实例应用redis做登录及状态检查</p></blockquote> <ol><li><p>添加pom依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>application.properties配置</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token comment">#redis</span>
<span class="token attr-name">spring.redis.database</span><span class="token punctuation">=</span><span class="token attr-value">0</span>
<span class="token attr-name">spring.redis.host</span><span class="token punctuation">=</span><span class="token attr-value">111.111.111.111</span>
<span class="token attr-name">spring.redis.port</span><span class="token punctuation">=</span><span class="token attr-value">6379</span>
<span class="token attr-name">spring.redis.password</span><span class="token punctuation">=</span><span class="token attr-value">root@234</span>
<span class="token comment">#连接池最大连接数</span>
<span class="token attr-name">spring.redis.jedis.pool.max-active</span><span class="token punctuation">=</span><span class="token attr-value">8</span>
<span class="token comment">#连接池最大阻塞等待时间 默认 -1 表示没有限制</span>
<span class="token attr-name">spring.redis.jedis.pool.max-wait</span><span class="token punctuation">=</span><span class="token attr-value">-1ms</span>
<span class="token comment">#连接池最大空闲连接数</span>
<span class="token attr-name">spring.redis.jedis.pool.max-idle</span><span class="token punctuation">=</span><span class="token attr-value">8</span>
<span class="token comment">#连接池最小空闲连接数</span>
<span class="token attr-name">spring.redis.jedis.pool.min-idle</span><span class="token punctuation">=</span><span class="token attr-value">0</span>
</code></pre></div></li> <li><p>使用redis</p> <ul><li>登录/退出/请求状态监测</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.29 - 12:52
 **/</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">RedisTemplate</span> redisTemplate<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">StringRedisTemplate</span> stringRedisTemplate<span class="token punctuation">;</span>
    <span class="token comment">/**
    *  登录信息缓存时长
    * */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> EXPIRATION_TIME <span class="token operator">=</span>  <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/status&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ModelMap</span> <span class="token function">isLogin</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">ModelMap</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> authorization <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;authorization&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>authorization <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token operator">||</span>authorization <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            response<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token number">345</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">String</span> isLogin <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>authorization<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span><span class="token operator">==</span>isLogin<span class="token punctuation">)</span><span class="token punctuation">{</span>
            response<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token number">345</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;sa&quot;</span><span class="token punctuation">,</span>isLogin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ModelMap</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span><span class="token class-name">String</span> password<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">ValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ops <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> token <span class="token operator">=</span> <span class="token class-name">DigestUtils</span><span class="token punctuation">.</span><span class="token function">sha1DigestAsHex</span><span class="token punctuation">(</span>username <span class="token operator">+</span> <span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">getRandomString</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">+</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getRole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;SuperAdmin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                ops<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span> EXPIRATION_TIME<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
                ops<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token string">&quot;false&quot;</span><span class="token punctuation">,</span> EXPIRATION_TIME<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ModelMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">,</span>token<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;role&quot;</span><span class="token punctuation">,</span>user<span class="token punctuation">.</span><span class="token function">getRole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ModelMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>



    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/logout&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ModelMap</span> <span class="token function">logout</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">ValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ops <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;authorization&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Boolean</span> result <span class="token operator">=</span> ops<span class="token punctuation">.</span><span class="token function">getOperations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;authorization&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ModelMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;tip&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;退出成功！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ModelMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;tip&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;退出失败！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>拦截器拦截请求并检查状态</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.06.13 - 16:52
 **/</span>
<span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">StringRedisTemplate</span> stringRedisTemplate<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;MainInterceptor...拦截...&quot;</span><span class="token operator">+</span>request<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> authorization <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;authorization&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>authorization <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token operator">||</span>authorization <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            response<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token number">345</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Boolean</span> isLogin <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">hasKey</span><span class="token punctuation">(</span>authorization<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isLogin<span class="token punctuation">)</span><span class="token punctuation">{</span>
            response<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token number">345</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;key是否存在：&quot;</span><span class="token operator">+</span>stringRedisTemplate<span class="token punctuation">.</span><span class="token function">hasKey</span><span class="token punctuation">(</span>authorization<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;key过期时间：&quot;</span><span class="token operator">+</span>stringRedisTemplate<span class="token punctuation">.</span><span class="token function">getExpire</span><span class="token punctuation">(</span>authorization<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stringRedisTemplate<span class="token punctuation">.</span><span class="token function">expire</span><span class="token punctuation">(</span>authorization<span class="token punctuation">,</span> <span class="token class-name">MainController</span><span class="token punctuation">.</span>EXPIRATION_TIME<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">ModelAndView</span> modelAndView<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;MainInterceptor...postHandle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCompletion</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;MainInterceptor...afterCompletion&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h2 id="springboot整合swagger-2"><a href="#springboot整合swagger-2" aria-hidden="true" class="header-anchor">#</a> SpringBoot整合Swagger 2</h2> <ol><li><p>添加pom依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.springfox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>springfox-swagger2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.9.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.springfox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>springfox-swagger-ui<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.9.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>启动类添加@EnableSwagger2注解</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EnableSwagger2</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div></li> <li><p>启动项目，访问路径：http://localhost:8080/swagger-ui.html</p></li> <li><p>运行结果：</p> <p><img src="/assets/img/1563256754899.a80360f1.png" alt="1563256754899"></p></li></ol> <hr> <h2 id="springboot整合websocket"><a href="#springboot整合websocket" aria-hidden="true" class="header-anchor">#</a> SpringBoot整合WebSocket</h2> <ol><li><p>添加pom依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-websocket<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>添加配置</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSocketConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ServerEndpointExporter</span> <span class="token function">serverEndpointExporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ServerEndpointExporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>编写WebSocket映射类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ServerEndpoint</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/socket&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSocketController</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token comment">//静态变量，用来记录当前在线连接数。应该把它设计成线程安全的。</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> onlineCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">//concurrent包的线程安全Set，用来存放每个客户端对应的MyWebSocket对象。</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">CopyOnWriteArraySet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WebSocketController</span><span class="token punctuation">&gt;</span></span> webSocketSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CopyOnWriteArraySet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WebSocketController</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//与某个客户端的连接会话，需要通过它来给客户端发送数据</span>
    <span class="token keyword">private</span> <span class="token class-name">Session</span> session<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 连接建立成功调用的方法*/</span>
    <span class="token annotation punctuation">@OnOpen</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span><span class="token function">getAsyncRemote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>session <span class="token operator">=</span> session<span class="token punctuation">;</span>
        webSocketSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//加入set中</span>
        <span class="token function">addOnlineCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//在线数加1</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;有新连接加入！当前在线人数为&quot;</span> <span class="token operator">+</span> <span class="token function">getOnlineCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token string">&quot;wsyjlly&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 连接关闭调用的方法
     */</span>
    <span class="token annotation punctuation">@OnClose</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        webSocketSet<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//从set中删除</span>
        <span class="token function">subOnlineCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//在线数减1</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;有一连接关闭！当前在线人数为&quot;</span> <span class="token operator">+</span> <span class="token function">getOnlineCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 收到客户端消息后调用的方法
     *
     * @param message 客户端发送过来的消息*/</span>
    <span class="token annotation punctuation">@OnMessage</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onMessage</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">,</span> <span class="token class-name">Session</span> session<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;来自客户端的消息:&quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//群发消息</span>
        <span class="token function">sendInfo</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 发生错误时调用
     * @OnError
     **/</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onError</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;发生错误&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        error<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>session<span class="token punctuation">.</span><span class="token function">getAsyncRemote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendText</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * 群发自定义消息
     * */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">sendInfo</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">WebSocketController</span> item <span class="token operator">:</span> webSocketSet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            item<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token keyword">int</span> <span class="token function">getOnlineCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> onlineCount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">addOnlineCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">WebSocketController</span><span class="token punctuation">.</span>onlineCount<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">subOnlineCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">WebSocketController</span><span class="token punctuation">.</span>onlineCount<span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <hr> <h2 id="springboot整合jms（activemq）"><a href="#springboot整合jms（activemq）" aria-hidden="true" class="header-anchor">#</a> SpringBoot整合JMS（ActiveMQ）</h2> <blockquote><p>消息队列（Message Queue）是一种进程间或线程间的异步通信方式，使用消息队列消息生产者在消息产生后，会将消息保存在消息队列中直到消费者来取走它，即消息的发送者和接收者不需要与消息队列交互。使用消息队列可以可以有效实现服务的解耦，并提高系统的可靠性一级可扩展性。</p> <p>JMS（Java Message Service）即Java消息服务，通过同一Java API层面的标准，使得多个客户端可以通过JMS进行交互，大多数消息中间件都对JMS提供支持。JMS包括两种消息模型：</p> <ul><li>点对点</li> <li>发布者/订阅者</li></ul> <p>JMS仅支持Java平台</p></blockquote> <ol><li><p>添加pom依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-activemq<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>application.properties配置</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">spring.activemq.broker-url</span><span class="token punctuation">=</span><span class="token attr-value">tcp://***.***.***.***:61616</span>
<span class="token attr-name">spring.activemq.packages.trust-all</span><span class="token punctuation">=</span><span class="token attr-value">true</span>
<span class="token attr-name">spring.activemq.user</span><span class="token punctuation">=</span><span class="token attr-value">admin</span>
<span class="token attr-name">spring.activemq.password</span><span class="token punctuation">=</span><span class="token attr-value">***</span>
</code></pre></div></li></ol> <hr> <h2 id="springboot整合amqp（rabbitmq）"><a href="#springboot整合amqp（rabbitmq）" aria-hidden="true" class="header-anchor">#</a> SpringBoot整合AMQP（RabbitMQ）</h2> <ol><li><p>添加pom依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-amqp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>application.properties配置</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">spring.rabbitmq.host</span><span class="token punctuation">=</span><span class="token attr-value">***.***.***.***</span>
<span class="token attr-name">spring.rabbitmq.port</span><span class="token punctuation">=</span><span class="token attr-value">5762</span>
</code></pre></div></li></ol> <p>spring.rabbitmq.username=admin
spring.rabbitmq.password=***
```</p> <ol start="3"><li><p>在RabbitMQ中所有的消息生产者提交的消息都会交由Exchange进行再分配，Exchange会根据不同的策略将消息分发到不同的Queue中。RabbitMQ提供了4种不同策略，分别是Direct、Fanout、Topic、Header，4种策略中前三种使用率较高</p> <ul><li><p>Direct</p> <blockquote><p>DirectExchange的路由策略是将消息队列绑定到一个DirectExchange上，但一条消息到达DirectExchange时会被转发到与该条消息routing key相同的Queue上</p></blockquote> <ul><li><p>DirectExchange的配置如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 21:33
 **/</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitDirectConfig</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span> DIRECTNAME <span class="token operator">=</span> <span class="token string">&quot;ysw-direct&quot;</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Queue</span> <span class="token function">queue1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">&quot;queue-direct1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>

    <span class="token class-name">Queue</span> <span class="token function">queue2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">&quot;queue-direct2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Queue</span> <span class="token function">queue3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">&quot;queue-direct3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">DirectExchange</span> <span class="token function">directExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DirectExchange</span><span class="token punctuation">(</span>DIRECTNAME<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Binding</span> <span class="token function">binding1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token function">queue1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span><span class="token function">directExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token string">&quot;direct1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Binding</span> <span class="token function">binding2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token function">queue2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span><span class="token function">directExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token string">&quot;direct2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>DirectExchange和Binding两个Bean的配置可以省略掉，即如果使用DirectExchange，之配置一个Queue的实例即可</p></blockquote></li> <li><p>配置消费者</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 21:42
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DirectReceiver</span> <span class="token punctuation">{</span>
    <span class="token class-name">Logger</span> logger<span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token string">&quot;queue-direct1&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">directHandler1</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[30;4m&quot;</span><span class="token operator">+</span><span class="token string">&quot;queue-direct1:&quot;</span><span class="token operator">+</span>msg<span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token string">&quot;queue-direct2&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">directHandler2</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[30;4m&quot;</span><span class="token operator">+</span><span class="token string">&quot;queue-direct2:&quot;</span><span class="token operator">+</span>msg<span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token string">&quot;queue-direct3&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">directHandler3</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[30;4m&quot;</span><span class="token operator">+</span><span class="token string">&quot;queue-direct3:&quot;</span><span class="token operator">+</span>msg<span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>通过@RabbitListener注解指定一个方法是一个消费者方法，方法参数就是所接收的消息。</p></blockquote></li> <li><p>消息发送</p> <blockquote><p>通过注入RabbitTemplate对象来进行消息发送，在这里我通过定时任务使其自定发送，须开启定时任务，详细操作可查看&lt;SpringBoot定时任务@Schedule&gt;一节</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.18 - 1:13
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitmqSchedule</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>
    <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>fixedDelay <span class="token operator">=</span> <span class="token number">5000</span><span class="token punctuation">,</span>initialDelay <span class="token operator">=</span> <span class="token number">3000</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">direct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> message <span class="token operator">=</span> <span class="token string">&quot;direct-task&quot;</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[30;4m&quot;</span><span class="token operator">+</span>message<span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;ysw-direct&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;direct1&quot;</span><span class="token punctuation">,</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;ysw-direct&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;direct2&quot;</span><span class="token punctuation">,</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;queue-direct3&quot;</span><span class="token punctuation">,</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p>Fanout</p> <blockquote><p>FanoutExchange的数据交换策略是把所有到达FanoutExchange的消息转发给所有与他绑定的Queue，在这种策略中，routingkey将不起作用。</p></blockquote> <ul><li><p>FanoutExchange的配置方式如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 21:33
 **/</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitFanoutConfig</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span> FANOUTNAME <span class="token operator">=</span> <span class="token string">&quot;ysw-fanout&quot;</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Queue</span> <span class="token function">queue4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">&quot;queue-fanout1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Queue</span> <span class="token function">queue5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">&quot;queue-fanout2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Queue</span> <span class="token function">queue6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">&quot;queue-fanout3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">FanoutExchange</span> <span class="token function">fanoutExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FanoutExchange</span><span class="token punctuation">(</span>FANOUTNAME<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Binding</span> <span class="token function">binding4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token function">queue4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span><span class="token function">fanoutExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Binding</span> <span class="token function">binding5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token function">queue5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span><span class="token function">fanoutExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Binding</span> <span class="token function">binding6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token function">queue6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span><span class="token function">fanoutExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>配置消费者</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 21:42
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FanoutReceiver</span> <span class="token punctuation">{</span>
    <span class="token class-name">Logger</span> logger<span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token string">&quot;queue-fanout1&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fanoutHandler1</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[31;4m&quot;</span><span class="token operator">+</span><span class="token string">&quot;queue-fanout1:&quot;</span><span class="token operator">+</span>msg<span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token string">&quot;queue-fanout2&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fanoutHandler2</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[31;4m&quot;</span><span class="token operator">+</span><span class="token string">&quot;queue-fanout2:&quot;</span><span class="token operator">+</span>msg<span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token string">&quot;queue-fanout3&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fanoutHandler3</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[31;4m&quot;</span><span class="token operator">+</span><span class="token string">&quot;queue-fanout3:&quot;</span><span class="token operator">+</span>msg<span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>消息发送</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.18 - 1:13
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitmqSchedule</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>
    <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Scheduled</span><span class="token punctuation">(</span>fixedDelay <span class="token operator">=</span> <span class="token number">5000</span><span class="token punctuation">,</span>initialDelay <span class="token operator">=</span> <span class="token number">4000</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fanout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> message <span class="token operator">=</span> <span class="token string">&quot;fanout-task&quot;</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[31;4m&quot;</span><span class="token operator">+</span>message<span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;ysw-fanout&quot;</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p>Topic</p> <blockquote><p>TopicExchange是比较复杂也比较灵活的一种路由策略，在TopicExchange中，Queue通过routingkey绑定到TopicExchange上，当消息发送到TopicExchange后，TopicExchange根据消息的routingkey将消息路由到一个或多个Queue上。</p></blockquote> <ul><li><p>TopicExchange配置如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 21:33
 **/</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitTopicConfig</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span> TOPIC_NAME <span class="token operator">=</span> <span class="token string">&quot;ysw-topic&quot;</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Queue</span> <span class="token function">queue7</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">&quot;queue-topic1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Queue</span> <span class="token function">queue8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">&quot;queue-topic2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Queue</span> <span class="token function">queue9</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">&quot;queue-topic3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">TopicExchange</span> <span class="token function">topicExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TopicExchange</span><span class="token punctuation">(</span>TOPIC_NAME<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Binding</span> <span class="token function">binding7</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token comment">/*
         * 匹配规则
         * 绑定键binding key也必须是这种形式。以特定路由键发送的消息将会发送到所有绑定键与之匹配的队列中。但绑定键有两种特殊的情况：
         * 绑定键binding key也必须是这种形式。以特定路由键发送的消息将会发送到所有绑定键与之匹配的队列中。但绑定键有两种特殊的情况：
         * ①*（星号）仅代表一个单词
         * ②#（井号）代表任意个单词
         **/</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token function">queue7</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span><span class="token function">topicExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token string">&quot;#.topic1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Binding</span> <span class="token function">binding8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token function">queue8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span><span class="token function">topicExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token string">&quot;topic2.#&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Binding</span> <span class="token function">binding9</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token function">queue9</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span><span class="token function">topicExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token string">&quot;#.topic3.*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>配置消费者</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 21:42
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TopicReceiver</span> <span class="token punctuation">{</span>
    <span class="token class-name">Logger</span> logger<span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token string">&quot;queue-topic1&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">topicHandler1</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[32;4m&quot;</span><span class="token operator">+</span><span class="token string">&quot;queue-topic1:&quot;</span><span class="token operator">+</span>msg<span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token string">&quot;queue-topic2&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">topicHandler2</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[32;4m&quot;</span><span class="token operator">+</span><span class="token string">&quot;queue-topic2:&quot;</span><span class="token operator">+</span>msg<span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token string">&quot;queue-topic3&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">topicHandler3</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[32;4m&quot;</span><span class="token operator">+</span><span class="token string">&quot;queue-topic3:&quot;</span><span class="token operator">+</span>msg<span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>消息发送</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.18 - 1:13
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitmqSchedule</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>
    <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">&quot;0-30/6 * * * * ?&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">topic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> message <span class="token operator">=</span> <span class="token string">&quot;topic-task&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[32;4m&quot;</span><span class="token operator">+</span>message<span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitTopicConfig</span><span class="token punctuation">.</span>TOPIC_NAME<span class="token punctuation">,</span>
        <span class="token string">&quot;topic1.news&quot;</span><span class="token punctuation">,</span>message <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//topic1</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitTopicConfig</span><span class="token punctuation">.</span>TOPIC_NAME<span class="token punctuation">,</span>
        <span class="token string">&quot;topic1.salary&quot;</span><span class="token punctuation">,</span>message <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//topic1</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitTopicConfig</span><span class="token punctuation">.</span>TOPIC_NAME<span class="token punctuation">,</span>
        <span class="token string">&quot;topic2.news&quot;</span><span class="token punctuation">,</span>message <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//topic2</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitTopicConfig</span><span class="token punctuation">.</span>TOPIC_NAME<span class="token punctuation">,</span>
        <span class="token string">&quot;topic2.item&quot;</span><span class="token punctuation">,</span>message <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//topic2</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitTopicConfig</span><span class="token punctuation">.</span>TOPIC_NAME<span class="token punctuation">,</span>
        <span class="token string">&quot;topic2.sth.topic1&quot;</span><span class="token punctuation">,</span>message <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//topic2&amp;topic1</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitTopicConfig</span><span class="token punctuation">.</span>TOPIC_NAME<span class="token punctuation">,</span>
        <span class="token string">&quot;topic1.sth.topic2&quot;</span><span class="token punctuation">,</span>message <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//topic2&amp;topic1</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitTopicConfig</span><span class="token punctuation">.</span>TOPIC_NAME<span class="token punctuation">,</span>
        <span class="token string">&quot;topic3&quot;</span><span class="token punctuation">,</span>message <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//topic3</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitTopicConfig</span><span class="token punctuation">.</span>TOPIC_NAME<span class="token punctuation">,</span>
        <span class="token string">&quot;topic3.news&quot;</span><span class="token punctuation">,</span>message <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//topic3</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitTopicConfig</span><span class="token punctuation">.</span>TOPIC_NAME<span class="token punctuation">,</span>
        <span class="token string">&quot;topic1.topic3&quot;</span><span class="token punctuation">,</span>message <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//topic1&amp;topic3</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitTopicConfig</span><span class="token punctuation">.</span>TOPIC_NAME<span class="token punctuation">,</span>
        <span class="token string">&quot;topic2.topic3&quot;</span><span class="token punctuation">,</span>message <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//topic2&amp;topic3</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitTopicConfig</span><span class="token punctuation">.</span>TOPIC_NAME<span class="token punctuation">,</span>
        <span class="token string">&quot;topic3.topic1&quot;</span><span class="token punctuation">,</span>message <span class="token operator">+</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//topic3&amp;topic1</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitTopicConfig</span><span class="token punctuation">.</span>TOPIC_NAME<span class="token punctuation">,</span>
        <span class="token string">&quot;topic2.topic3.topic1&quot;</span><span class="token punctuation">,</span>message <span class="token operator">+</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//topic1&amp;topic2&amp;topic3</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p>Header</p> <blockquote><p>HeaderExchange是一种较少使用的路由策略，HeaderExchange会根据消息的Header将消息路由到不同的Queue上，这种策略也和routingkey无关。</p></blockquote> <ul><li><p>HeaderExchange配置如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 21:33
 **/</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitHeaderConfig</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span> HEADER_NAME <span class="token operator">=</span> <span class="token string">&quot;ysw-header&quot;</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Queue</span> <span class="token function">queue10</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">&quot;queue-header1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>

    <span class="token class-name">Queue</span> <span class="token function">queue11</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">&quot;queue-header2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Queue</span> <span class="token function">queue12</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">&quot;queue-header3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">HeadersExchange</span> <span class="token function">headersExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HeadersExchange</span><span class="token punctuation">(</span>HEADER_NAME<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Binding</span> <span class="token function">binding10</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;18&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ysw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token function">queue10</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span><span class="token function">headersExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">whereAny</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Binding</span> <span class="token function">binding11</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ysw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token function">queue11</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span><span class="token function">headersExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Binding</span> <span class="token function">binding12</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;18&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ysw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token function">queue12</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span><span class="token function">headersExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">whereAll</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><blockquote><p>Binding配置注释：whereAny表示消息的Header中只要有一个Header匹配上map中的key/value，就把该消息路由到名为“queue-header1”的Queue上；whereAll方法表示消息的所有Header都要匹配，才将消息路由到名为“queue-header2”的Queue上；where表示只要消息的header中包含age，无论age值为多少，都将消息路由到名为“queue-header2”的Queue上。</p></blockquote></li> <li><p>配置消费者</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.17 - 21:42
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HeaderReceiver</span> <span class="token punctuation">{</span>
    <span class="token class-name">Logger</span> logger<span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token string">&quot;queue-header1&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">headerHandler1</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[33;4m&quot;</span><span class="token operator">+</span><span class="token string">&quot;queue-header1:&quot;</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>msg<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token string">&quot;queue-header2&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">headerHandler2</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[33;4m&quot;</span><span class="token operator">+</span><span class="token string">&quot;queue-header2:&quot;</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>msg<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token string">&quot;queue-header3&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">headerHandler3</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[33;4m&quot;</span><span class="token operator">+</span><span class="token string">&quot;queue-header3:&quot;</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>msg<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>消息发送</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * @author wsyjlly
 * @create 2019.07.18 - 1:13
 **/</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitmqSchedule</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>
    <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">&quot;0-30/3 * * * * ?&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> message <span class="token operator">=</span> <span class="token string">&quot;header-task&quot;</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\033[33;4m&quot;</span><span class="token operator">+</span>message<span class="token operator">+</span><span class="token string">&quot;\033[0m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Message</span> message1 <span class="token operator">=</span> <span class="token class-name">MessageBuilder</span><span class="token punctuation">.</span><span class="token function">withBody</span><span class="token punctuation">(</span><span class="token string">&quot;name=name&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;aaa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Message</span> message2 <span class="token operator">=</span> <span class="token class-name">MessageBuilder</span><span class="token punctuation">.</span><span class="token function">withBody</span><span class="token punctuation">(</span><span class="token string">&quot;name=ysw&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ysw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Message</span> message3 <span class="token operator">=</span> <span class="token class-name">MessageBuilder</span><span class="token punctuation">.</span><span class="token function">withBody</span><span class="token punctuation">(</span><span class="token string">&quot;age=19&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;19&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Message</span> message4 <span class="token operator">=</span> <span class="token class-name">MessageBuilder</span><span class="token punctuation">.</span><span class="token function">withBody</span><span class="token punctuation">(</span><span class="token string">&quot;age=18&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;18&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Message</span> message5 <span class="token operator">=</span> <span class="token class-name">MessageBuilder</span><span class="token punctuation">.</span><span class="token function">withBody</span><span class="token punctuation">(</span><span class="token string">&quot;name=ysw&amp;age=18&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ysw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;18&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Message</span> message6 <span class="token operator">=</span> <span class="token class-name">MessageBuilder</span><span class="token punctuation">.</span><span class="token function">withBody</span><span class="token punctuation">(</span><span class="token string">&quot;name=ysw&amp;age=19&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ysw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;19&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Message</span> message7 <span class="token operator">=</span> <span class="token class-name">MessageBuilder</span><span class="token punctuation">.</span><span class="token function">withBody</span><span class="token punctuation">(</span><span class="token string">&quot;name=aaa&amp;age=18&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;aaa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;18&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitHeaderConfig</span><span class="token punctuation">.</span>HEADER_NAME<span class="token punctuation">,</span>
        <span class="token keyword">null</span><span class="token punctuation">,</span>message1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitHeaderConfig</span><span class="token punctuation">.</span>HEADER_NAME<span class="token punctuation">,</span>
        <span class="token keyword">null</span><span class="token punctuation">,</span>message2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitHeaderConfig</span><span class="token punctuation">.</span>HEADER_NAME<span class="token punctuation">,</span>
        <span class="token keyword">null</span><span class="token punctuation">,</span>message3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitHeaderConfig</span><span class="token punctuation">.</span>HEADER_NAME<span class="token punctuation">,</span>
        <span class="token keyword">null</span><span class="token punctuation">,</span>message4<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitHeaderConfig</span><span class="token punctuation">.</span>HEADER_NAME<span class="token punctuation">,</span>
        <span class="token keyword">null</span><span class="token punctuation">,</span>message5<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitHeaderConfig</span><span class="token punctuation">.</span>HEADER_NAME<span class="token punctuation">,</span>
        <span class="token keyword">null</span><span class="token punctuation">,</span>message6<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitHeaderConfig</span><span class="token punctuation">.</span>HEADER_NAME<span class="token punctuation">,</span>
        <span class="token keyword">null</span><span class="token punctuation">,</span>message7<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul></li></ol> <hr> <h2 id="springboot-docker远程发布"><a href="#springboot-docker远程发布" aria-hidden="true" class="header-anchor">#</a> SpringBoot Docker远程发布</h2> <blockquote><p>docker远程发布有2种方法一种是直接利用mevan的docker插件配置发布参数，另一种是使用Dockerfile文件发布</p></blockquote> <ol><li><p>方式一：插件配置发布</p> <ul><li><p>maven配置</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.spotify<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>docker-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dockerHost</span><span class="token punctuation">&gt;</span></span>http://***.***.***.***:2375<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dockerHost</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>imageName</span><span class="token punctuation">&gt;</span></span>${project.name}:${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>imageName</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>workdir</span><span class="token punctuation">&gt;</span></span>/ysw/app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>workdir</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>volumes</span><span class="token punctuation">&gt;</span></span>/ysw/app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>volumes</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>baseImage</span><span class="token punctuation">&gt;</span></span>java:8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>baseImage</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entryPoint</span><span class="token punctuation">&gt;</span></span>[&quot;java&quot;, &quot;-jar&quot;, &quot;/ysw/app/${project.build.finalName}.jar&quot;]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entryPoint</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>targetPath</span><span class="token punctuation">&gt;</span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>targetPath</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">&gt;</span></span>${project.build.directory}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">&gt;</span></span>${project.build.finalName}.jar<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>maven命令发布：<code>clean package docker:build</code></p> <p><img src="data:image/png;base64,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" alt="1563257611814"></p></li></ul></li> <li><p>方式二：Dockerfile构建</p> <ul><li><p>maven插件配置</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.spotify<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>docker-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dockerHost</span><span class="token punctuation">&gt;</span></span>http://***.***.***.***:2375<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dockerHost</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>imageName</span><span class="token punctuation">&gt;</span></span>${project.name}:${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>imageName</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dockerDirectory</span><span class="token punctuation">&gt;</span></span>src/main/docker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dockerDirectory</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>targetPath</span><span class="token punctuation">&gt;</span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>targetPath</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">&gt;</span></span>${project.build.directory}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">&gt;</span></span>${project.build.finalName}.jar<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>Dockerfile内容</p> <div class="language- extra-class"><pre class="language-text"><code>FROM 		java:8
#FROM        tomcat:8
# 环境变量
ENV APP 	app-0.0.1-SNAPSHOT.jar

WORKDIR     /ysw/app
VOLUME 		/ysw/app
ADD			$APP /ysw/app/app.jar
ENTRYPOINT 	[&quot;java&quot;, &quot;-jar&quot;, &quot;/ysw/app/app.jar&quot;]
EXPOSE 		8080
</code></pre></div></li> <li><p>Dockerfile位置</p> <p><img src="/assets/img/1563257520848.18b3c61b.png" alt="1563257520848"></p></li> <li><p>maven命令发布：<code>clean package docker:build</code></p> <p><img src="data:image/png;base64,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" alt="1563257611814"></p></li></ul></li></ol> <h2 id="springboot自定义banner"><a href="#springboot自定义banner" aria-hidden="true" class="header-anchor">#</a> SpringBoot自定义Banner</h2> <p><code>官方提供的application.yml的banner配置信息</code></p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token comment"># BANNER</span>
<span class="token attr-name">spring.banner.charset</span><span class="token punctuation">=</span><span class="token attr-value">UTF-8 # Banner file encoding.</span>
<span class="token attr-name">spring.banner.location</span><span class="token punctuation">=</span><span class="token attr-value">classpath:banner.txt # Banner text resource location.</span>
<span class="token attr-name">spring.banner.image.location</span><span class="token punctuation">=</span><span class="token attr-value">classpath:banner.gif # Banner image file location (jpg or png can also be used).</span>
<span class="token attr-name">spring.banner.image.width</span><span class="token punctuation">=</span><span class="token attr-value">76 # Width of the banner image in chars.</span>
<span class="token attr-name">spring.banner.image.height</span><span class="token punctuation">=</span> <span class="token attr-value"># Height of the banner image in chars (default based on image height).</span>
<span class="token attr-name">spring.banner.image.margin</span><span class="token punctuation">=</span><span class="token attr-value">2 # Left hand image margin in chars.</span>
<span class="token attr-name">spring.banner.image.invert</span><span class="token punctuation">=</span><span class="token attr-value">false # Whether images should be inverted for dark terminal themes.</span>
</code></pre></div><blockquote><p>在resource文件夹下放一个以“banner.txt”命名的文件，文件中是你要显示的banner字符图案</p> <p>图案生成地址：</p> <ul><li>http://kammerl.de/ascii/AsciiSignature.php</li> <li>http://network-science.de/ascii/</li> <li>http://patorjk.com/software/taag</li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>    ____    __       ___   __   _____     _     ____     _____   __   __
|  |    |  |  )  ____) (  (  )  )   (_   | \   |    \   |    (  (  )  ) 
|  |    |  | (  (___    \  \/  /      |  |  |  |     |  |     \  \/  /  
|  |    |  |  \___  \    \    /    _  |  |  |  |     |  |      \    /   
 \  \/\/  /   ____)  )    )  /    ( |_|  |  |  |__   |  |__     )  /    
__\      /___(      (____/  (______\    /__/      )_/      )___/  (_____
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>.-.   .-.  .---. .-.  .-.
 \ \_/ )/ ( .-._)| |/\| |
  \   (_)(_) \   | /  \ |
   ) (   _  \ \  |  /\  |
   | |  ( `-'  ) |(/  \ |
  /(_|   `----'  (_)   \|
 (__)                    
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>O~~   O~~ O~~~~ O~~      O~~
 O~~ O~~ O~~     O~~  ~  O~~
   O~~~    O~~~  O~~ O~  O~~
    O~~      O~~ O~ O~ O~O~~
   O~~   O~~ O~~O~~~     O~~
 O~~                        
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code> _  _  ___  _    _ 
( \/ )/ __)( \/\/ )
 \  / \__ \ \    / 
(__/  (___/  \/\/  
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>  ^    ^    ^  
 /y\  /s\  /w\ 
&lt;___&gt;&lt;___&gt;&lt;___&gt;
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>  __ ______    __
 / // (_-&lt; |/|/ /
 \_, /___/__,__/ 
/___/            
</code></pre></div><hr></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/Java/MybatisPlus.html">
          MybatisPlus
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.2d4845b5.js" defer></script><script src="/assets/js/2.974af1fb.js" defer></script><script src="/assets/js/3.b9e90bed.js" defer></script>
  </body>
</html>
